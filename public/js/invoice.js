!function(t){var e={};function a(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=4)}({4:function(t,e,a){t.exports=a("KAC9")},KAC9:function(t,e,a){"use strict";var n=$("#loading_modal_btn"),i=$("#loading_modal"),o=$("#table_content"),r=$("#invoices_form"),l={headboard:{},value:!1,detail:[]},c=[];r.submit((function(t){if(t.preventDefault(),l.value)$.ajax({url:Laravel.invoices_store,type:"POST",headers:{"X-CSRF-TOKEN":Laravel.csrfToken},dataType:"JSON",data:l,beforeSend:function(){n.click()}}).done((function(t){setTimeout((function(){if(t.value){i.find("h1").hide();showAlert("success","¡Transacción exitosa!",(function(){var e=t.invoice_id,a=Laravel.invoice_pdf.replace("param",e);window.open(a),window.location.href=Laravel.invoices_index}))}else{n.click();showAlert("warning","¡El código ingresado ya existe!")}}),1500)})).fail((function(t){console.log(t.responseText)})).always((function(t){}));else{showAlert("warning","¡Falta llenar información!")}})),window.seeDetail=function(t){$("#detail_content table").DataTable().destroy();var e=$("#detail_content table tbody"),a="",n=0,i=0,o=0;t.forEach((function(t,e){a+="\n\t\t\t<tr>\n\t\t\t\t<td>".concat(t.name,'</td>\n\t\t\t\t<td class="text-center">').concat(t.quantity,'</td>\n\t\t\t\t<td class="text-right">').concat(t.price,'</td>\n\t\t\t\t<td class="text-right">').concat(t.subtotal,'</td>\n\t\t\t\t<td class="text-right">').concat(t.iva_value,'</td>\n\t\t\t\t<td class="text-right">').concat(t.total,"</td>\n\t\t\t</tr>\n\t\t"),n+=Number(t.subtotal),i+=Number(t.iva_value),o+=Number(t.total)})),e.html(a),$("#subtotal_final").text(n.toFixed(2)),$("#iva_final").text(i.toFixed(2)),$("#total_final").text(o.toFixed(2)),redrawDataTable("#detail_content table")},window.addTable=function(t){o.html('\n\t\t<table id="invoices_table" class="table table-hover table-bordered w-100">\n\t\t    <thead>\n\t\t        <tr>\n\t\t        \t<th></th>\n\t\t            <th>Producto</th>\n\t\t            <th>Cantidad</th>\n\t\t            <th>Precio</th>\n\t\t            <th>Subtotal</th>\n\t\t            <th>IVA</th>\n\t\t            <th>Total</th>\n\t\t        </tr>\n\t\t    </thead>\n\t\t    <tfoot>\n\t\t        <tr>\n\t\t            <th colspan="4" class="text-center">\n\t\t            \tTotal\n\t\t            </th>\n\t\t            <th id="final_subtotal" style="vertical-align: middle; text-align: center;"></th>\n\t\t            <th id="final_iva" style="vertical-align: middle; text-align: center;"></th>\n\t\t            <th id="final_total" style="vertical-align: middle; text-align: center;"></th>\n\t\t        </tr>\n\t\t    </tfoot>\n\t\t</table>\n\t'),$("#invoices_table").DataTable().destroy();var e=$("#invoices_table").DataTable({lengthChange:!1,ordering:!1,paging:!1,language:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron datos",sEmptyTable:"No existen registros",sInfo:"_MAX_ registros disponibles",sInfoEmpty:"0 registros disponibles",sInfoFiltered:"(Se filtraron _TOTAL_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"Último",sNext:"Siguiente",sPrevious:"Anterior"}}}),a=1;$("#addRow").on("click",(function(){var t=getOptionsForSelect();e.row.add(['<img src="/img/delete_row.svg" style="max-height: 20px; cursor: pointer;"\n            \t\tid="delete_btn_'.concat(a,'" />'),'<select class="selectpicker form-control"\n            \t\tdata-live-search="true"\n            \t\tonchange="putDataOfItem(this); calculateOfItem(this); verifySameItem(this, \'invoices_table\');"\n            >\n            \t'.concat(t,"\n            </select>"),'<input type="text"\n            \t\tclass="form-control"\n            \t\tonkeypress="return validateNumber(event);"\n            \t\toninput="calculateOfItem(this); verifyStock(this);"\n            />',"","","",""]).draw(!1),$("#delete_btn_".concat(a)).on("click",(function(){e.row($(this).parents("tr")).remove().draw(!1),calculateAllItems()})),a++,o.find("select").selectpicker(),calculateAllItems()})),$("#addRow").removeClass("d-none"),t.remove()},window.verifyStock=function(t){var e=$().add(t).parents("tr").find("td"),a=Number(e.eq(1).find("select").val()),n=getItem(a);if(n.value&&n.data.stock<Number(t.value)){showAlert("warning","La cantidad digitada sobrepasa el stock",(function(){t.value="0"}))}},window.calculateOfItem=function(t){var e=$().add(t).parents("tr").find("td"),a=Number(e.eq(1).find("select").val()),n=getItem(a);if(n.value){var i=Number(n.data.price),o=Number(e.eq(2).find("input").val())*i,r=n.data.item.is_iva?.12*o:0,l=o+r;e.eq(4).css({"text-align":"right","vertical-align":"middle"}).text(o.toFixed(2)),e.eq(5).css({"text-align":"right","vertical-align":"middle"}).text(r.toFixed(2)),e.eq(6).css({"text-align":"right","vertical-align":"middle"}).text(l.toFixed(2))}else e.eq(4).text(""),e.eq(5).text(""),e.eq(6).text("");calculateAllItems()},window.calculateAllItems=function(){var t=o.find("table tbody tr"),e=0,a=0,n=0;c=[];var i=!0;t.each((function(t,o){var r=$().add(o).find("td"),l=Number(r.eq(1).find("select").val()),d=getItem(l);if(d.value){var s=Number(d.data.price),u=Number(r.eq(2).find("input").val()),f=u*s,v=d.data.item.is_iva?.12*f:0,m=f+v;e+=f,a+=v,n+=m;var g={name:d.data.item.name,quantity:u,price:s,subtotal:f,iva_value:v,total:m,item_id:d.data.item.id};c.push(g),u||(i=!1)}else e+=0,a+=0,n+=0,i=!1})),$("#final_subtotal").css({"text-align":"right","vertical-align":"middle"}).text(e.toFixed(2)),$("#final_iva").css({"text-align":"right","vertical-align":"middle"}).text(a.toFixed(2)),$("#final_total").css({"text-align":"right","vertical-align":"middle"}).text(n.toFixed(2));var r=$("#invoice_code").val().toString().trim(),d=$("#payment_type_id").val().toString().trim(),s=Number($("#customer_id").val());l.value=i&&!!r.length&&!!c.length,l.detail=c,l.headboard={invoice_code:r,payment_type_id:d,subtotal:e,iva_value:a,total:n,customer_id:s}},window.putDataOfItem=function(t){var e=Number(t.value),a=$().add(t).parents("tr").find("td"),n=getItem(e);n.value?a.eq(3).css({"text-align":"right","vertical-align":"middle"}).text(n.data.price):a.eq(3).text("")},window.getItem=function(t){if(t){var e=[];return products.forEach((function(a,n){a.id==t&&(e=a)})),{value:!0,data:e}}return{value:!1,data:""}},window.getOptionsForSelect=function(){var t='<option value="0">--Seleccionar--</option>';return products.forEach((function(e,a){t+='\n\t\t\t<option value="'.concat(e.id,'">').concat(e.item.name,"</option>\n\t\t")})),t}}});